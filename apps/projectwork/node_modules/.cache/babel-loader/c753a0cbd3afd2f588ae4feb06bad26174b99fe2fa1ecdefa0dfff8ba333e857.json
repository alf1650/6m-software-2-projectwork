{"ast":null,"code":"import _regeneratorRuntime from\"/Users/alfredlim/sctp/6m-software-2-projectwork/apps/projectwork/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/alfredlim/sctp/6m-software-2-projectwork/apps/projectwork/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/alfredlim/sctp/6m-software-2-projectwork/apps/projectwork/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import styles from\"../css-modules/Search.module.css\";import{useState,useEffect}from\"react\";import{createSearchParams,useNavigate}from\"react-router-dom\";import useUserState from\"../store/userStateContext\";import countriesAPI from\"../api/countriesAPI\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Search(){var _useUserState=useUserState(),username=_useUserState.username,countriesList=_useUserState.countriesList,updateCountriesList=_useUserState.updateCountriesList,selectedCountry=_useUserState.selectedCountry,updateCountry=_useUserState.updateCountry,selectedYear=_useUserState.selectedYear,updateYear=_useUserState.updateYear;var _useState=useState(\"false\"),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1];var navigate=useNavigate();var API_KEYS_ARRAY=process.env.REACT_APP_API_KEY.split(\" \");//.env contains string with 2 keys, .split to access\nvar COUNTRY_API_KEY=API_KEYS_ARRAY[0];useEffect(function(){var fetchCountries=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:setIsLoading(true);_context.prev=1;_context.next=4;return countriesAPI.get(\"/countries\",{params:{api_key:COUNTRY_API_KEY}});case 4:response=_context.sent;updateCountriesList(response.data.response.countries);setIsLoading(false);_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](1);console.error(\"Error fetching countries:\",_context.t0);case 12:case\"end\":return _context.stop();}},_callee,null,[[1,9]]);}));return function fetchCountries(){return _ref.apply(this,arguments);};}();fetchCountries();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);var handleChange=function handleChange(e){var countryData=countriesList.filter(function(country){return country.country_name===e.target.value;});updateCountry({name:e.target.value,code:countryData[0][\"iso-3166\"]});};var handleSubmit=function handleSubmit(e){e.preventDefault();navigate({pathname:\"/results\",search:\"?\".concat(createSearchParams({country:selectedCountry.code,year:selectedYear}))});};return/*#__PURE__*/_jsxs(\"div\",{className:styles.form,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Hi, \".concat(username,\"!\")}),/*#__PURE__*/_jsx(\"p\",{children:\" Where would you like to go?\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"label\",{children:\"I would like to visit: \"}),/*#__PURE__*/_jsxs(\"select\",{className:styles.select,value:selectedCountry.name,onChange:handleChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:isLoading?\"Loading...\":\"Select a country\"}),countriesList.map(function(country,i){return/*#__PURE__*/_jsx(\"option\",{value:country.country_name,children:country.country_name},i);})]}),/*#__PURE__*/_jsx(\"label\",{children:\" in: \"}),/*#__PURE__*/_jsx(\"input\",{className:styles.year,type:\"number\",min:\"1900\",max:\"2099\",step:\"1\",value:selectedYear,onChange:function onChange(e){return updateYear(e.target.value);}}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"button\",{className:styles.button,type:\"submit\",disabled:selectedCountry.name?false:true,children:\"Get me some info!\"})]})]});}export default Search;","map":{"version":3,"names":["styles","useState","useEffect","createSearchParams","useNavigate","useUserState","countriesAPI","jsx","_jsx","jsxs","_jsxs","Search","_useUserState","username","countriesList","updateCountriesList","selectedCountry","updateCountry","selectedYear","updateYear","_useState","_useState2","_slicedToArray","isLoading","setIsLoading","navigate","API_KEYS_ARRAY","process","env","REACT_APP_API_KEY","split","COUNTRY_API_KEY","fetchCountries","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","wrap","_callee$","_context","prev","next","get","params","api_key","sent","data","countries","t0","console","error","stop","apply","arguments","handleChange","e","countryData","filter","country","country_name","target","value","name","code","handleSubmit","preventDefault","pathname","search","concat","year","className","form","children","onSubmit","select","onChange","map","i","type","min","max","step","button","disabled"],"sources":["/Users/alfredlim/sctp/6m-software-2-projectwork/apps/projectwork/src/pages/Search.js"],"sourcesContent":["import styles from \"../css-modules/Search.module.css\";\nimport { useState, useEffect } from \"react\";\nimport { createSearchParams, useNavigate } from \"react-router-dom\";\nimport useUserState from \"../store/userStateContext\";\nimport countriesAPI from \"../api/countriesAPI\";\n\nfunction Search() {\n  const {\n    username,\n    countriesList,\n    updateCountriesList,\n    selectedCountry,\n    updateCountry,\n    selectedYear,\n    updateYear,\n  } = useUserState();\n  const [isLoading, setIsLoading] = useState(\"false\");\n  const navigate = useNavigate();\n\n  const API_KEYS_ARRAY = process.env.REACT_APP_API_KEY.split(\" \"); //.env contains string with 2 keys, .split to access\n  const COUNTRY_API_KEY = API_KEYS_ARRAY[0];\n\n  useEffect(() => {\n    const fetchCountries = async () => {\n      setIsLoading(true);\n      try {\n        const response = await countriesAPI.get(\"/countries\", {\n          params: {\n            api_key: COUNTRY_API_KEY,\n          },\n        });\n        updateCountriesList(response.data.response.countries);\n        setIsLoading(false);\n      } catch (error) {\n        console.error(\"Error fetching countries:\", error);\n      }\n    };\n    fetchCountries();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const handleChange = (e) => {\n    const countryData = countriesList.filter(\n      (country) => country.country_name === e.target.value\n    );\n    updateCountry({ name: e.target.value, code: countryData[0][\"iso-3166\"] });\n  };\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    navigate({\n      pathname: \"/results\",\n      search: `?${createSearchParams({\n        country: selectedCountry.code,\n        year: selectedYear,\n      })}`,\n    });\n  };\n\n  return (\n    <div className={styles.form}>\n      <h2>{`Hi, ${username}!`}</h2>\n      <p> Where would you like to go?</p>\n      <br />\n      <form onSubmit={handleSubmit}>\n        <label>I would like to visit: </label>\n        <select\n          className={styles.select}\n          value={selectedCountry.name}\n          onChange={handleChange}\n        >\n          <option value=\"\">\n            {isLoading ? \"Loading...\" : \"Select a country\"}\n          </option>\n          {countriesList.map((country, i) => (\n            <option key={i} value={country.country_name}>\n              {country.country_name}\n            </option>\n          ))}\n        </select>\n        <label> in: </label>\n        <input\n          className={styles.year}\n          type=\"number\"\n          min=\"1900\"\n          max=\"2099\"\n          step=\"1\"\n          value={selectedYear}\n          onChange={(e) => updateYear(e.target.value)}\n        />\n        <br />\n        <br />\n        <br />\n        <button\n          className={styles.button}\n          type=\"submit\"\n          disabled={selectedCountry.name ? false : true}\n        >\n          Get me some info!\n        </button>\n      </form>\n    </div>\n  );\n}\n\nexport default Search;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}